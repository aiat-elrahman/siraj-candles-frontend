(function(g,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],a):(g=typeof globalThis<"u"?globalThis:g||self,a(g.AdminProductUploader={},g.React))})(this,function(g,a){"use strict";var T={exports:{}},j={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G=a,W=Symbol.for("react.element"),H=Symbol.for("react.fragment"),X=Object.prototype.hasOwnProperty,K=G.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Y={key:!0,ref:!0,__self:!0,__source:!0};function O(s,n,c){var d,m={},o=null,h=null;c!==void 0&&(o=""+c),n.key!==void 0&&(o=""+n.key),n.ref!==void 0&&(h=n.ref);for(d in n)X.call(n,d)&&!Y.hasOwnProperty(d)&&(m[d]=n[d]);if(s&&s.defaultProps)for(d in n=s.defaultProps,n)m[d]===void 0&&(m[d]=n[d]);return{$$typeof:W,type:s,key:o,ref:h,props:m,_owner:K.current}}j.Fragment=H,j.jsx=O,j.jsxs=O,T.exports=j;var e=T.exports;/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),B=(...s)=>s.filter((n,c,d)=>!!n&&d.indexOf(n)===c).join(" ");/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=a.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:c=2,absoluteStrokeWidth:d,className:m="",children:o,iconNode:h,...N},v)=>a.createElement("svg",{ref:v,...$,width:n,height:n,stroke:s,strokeWidth:d?Number(c)*24/Number(n):c,className:B("lucide",m),...N},[...h.map(([k,w])=>a.createElement(k,w)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=(s,n)=>{const c=a.forwardRef(({className:d,...m},o)=>a.createElement(q,{ref:o,iconNode:n,className:B(`lucide-${Q(s)}`,d),...m}));return c.displayName=`${s}`,c};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=b("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=b("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=b("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=b("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=b("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=b("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),y="https://siraj-backend.onrender.com",C={subProductName:"Item",size:"",allowedScents:["Vanilla Cookie"]},_={_id:null,productType:"Single",category:"",price_egp:0,stock:0,status:"Active",featured:!1,name_en:"",description_en:"",scents:[],size:"",formattedDescription:"",burnTime:"",wickType:"",coverageSpace:"",bundleName:"",bundleDescription:"",bundleItems:[{...C,subProductName:"Big Jar Candle 1"},{...C,subProductName:"Big Jar Candle 2"},{...C,subProductName:"Wax Freshener"}],selectedFiles:[],imagePaths:[]},oe=()=>{var z,V;const[s,n]=a.useState(_),[c,d]=a.useState(!1),[m,o]=a.useState(""),[h,N]=a.useState([]),[v,k]=a.useState([]),[w,F]=a.useState(!0),[p,M]=a.useState(!1),[P,L]=a.useState(null),E=a.useCallback(async()=>{o("");try{const t=await fetch(`${y}/api/products?limit=1000&status=Active&status=Inactive`);if(!t.ok)throw new Error(`Failed to fetch products: ${t.statusText}`);const r=await t.json();N(r.results||[])}catch(t){console.error("Error fetching products:",t),o(`Error: Could not load products. ${t.message}`),N([])}},[]),D=a.useCallback(async()=>{o("");try{const t=await fetch(`${y}/api/orders`);if(!t.ok)throw new Error(`Failed to fetch orders: ${t.statusText}`);const r=await t.json();k(r||[])}catch(t){console.error("Error fetching orders:",t),o(`Error: Could not load orders. ${t.message}`),k([])}},[]);a.useEffect(()=>{F(!0),Promise.all([E(),D()]).catch(t=>console.error("Error during initial data load:",t)).finally(()=>F(!1))},[E,D]);const I=a.useCallback(()=>{n(_),M(!1);const t=document.getElementById("file-upload");t&&(t.value=null),o(""),window.scrollTo({top:0,behavior:"smooth"})},[]);a.useCallback(t=>{},[]),a.useCallback(t=>{},[]),a.useCallback(t=>{},[]),a.useCallback(t=>{const r=t.target.value.split(",").map(l=>l.trim()).filter(Boolean);n(l=>({...l,scents:r}))},[]),a.useCallback((t,r)=>{const l=r.split(",").map(i=>i.trim()).filter(Boolean);n(i=>{const x=[...i.bundleItems];return x[t].allowedScents=l,{...i,bundleItems:x}})},[]);const le=a.useCallback(t=>{},[]);a.useCallback(t=>{},[]),a.useCallback((t,r,l)=>{},[]),a.useCallback(()=>{},[s.bundleItems.length]),a.useCallback(t=>{},[]);const ne=async t=>{var S,J,Z;if(t.preventDefault(),d(!0),o(""),!p&&s.selectedFiles.length===0||!s.category)return;let r={productType:s.productType,category:s.category,price_egp:s.price_egp,stock:s.stock,status:s.status,featured:s.featured,scents:s.scents.join(", "),size:s.size,formattedDescription:s.formattedDescription,burnTime:s.burnTime,wickType:s.wickType,coverageSpace:s.coverageSpace};s.productType==="Single"?(r.name_en=s.name_en,r.description_en=s.description_en):(r.bundleName=s.bundleName,r.bundleDescription=s.bundleDescription,r.bundleItems=s.bundleItems.map(u=>({...u,allowedScents:u.allowedScents.join(", ")})),delete r.scents,delete r.size);const l=new FormData;s.selectedFiles.forEach(u=>{l.append("productImages",u)}),l.append("productData",JSON.stringify(r));const i=p?`${y}/api/products/${s._id}`:`${y}/api/products`,x=p?"PUT":"POST";try{const u=await fetch(i,{method:x,body:l}),f=await u.json();if(u.ok&&f.success){const ue=p?"updated":"created",pe=((S=f.product)==null?void 0:S.name_en)||((J=f.product)==null?void 0:J.bundleName)||((Z=f.product)==null?void 0:Z.name)||"product";o(`Success! Product "${pe}" ${ue}.`),I(),await E()}else o(`Error ${p?"updating":"creating"} product: ${f.message||f.error||`Server responded with status ${u.status}`}`),console.error("API Error:",f)}catch(u){o(`Network Error: ${u.message}. Please check connection or API URL.`),console.error("Submission Error:",u)}finally{d(!1)}},de=t=>{const r=(t.scents||"").split(",").map(x=>x.trim()).filter(Boolean),l=(t.bundleItems||[]).map(x=>({...x,allowedScents:(x.allowedScents||"").split(",").map(S=>S.trim()).filter(Boolean)}));n({..._,...t,_id:t._id,scents:r,bundleItems:l,selectedFiles:[],imagePaths:t.imagePaths||[]}),M(!0),o("Editing product. Upload images only to ADD new ones.");const i=document.getElementById("product-form-section");i&&i.scrollIntoView({behavior:"smooth"})},ie=async(t,r)=>{if(window.confirm(`Are you sure you want to delete "${r}"? This cannot be undone.`)){d(!0),o("");try{const l=await fetch(`${y}/api/products/${t}`,{method:"DELETE"}),i=await l.json();l.ok&&i.success?(o(`Success! Product "${r}" deleted.`),await E(),s._id===t&&I()):(o(`Error deleting product: ${i.message||i.error||`Status ${l.status}`}`),console.error("API Error:",i))}catch(l){o(`Network Error: ${l.message}.`),console.error("Delete Error:",l)}finally{d(!1)}}},ce=async(t,r)=>{if(window.confirm(`Update order ${t.slice(-6)} status to "${r}"?`)){d(!0);try{const l=await fetch(`${y}/api/orders/${t}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:r})}),i=await l.json();l.ok&&i.order?(console.log(`Order ${t.slice(-6)} status updated.`),await D()):(o(`Error updating order: ${i.message||i.error||`Status ${l.status}`}`),console.error("API Error:",i))}catch(l){o(`Network Error: ${l.message}.`),console.error("Order Update Error:",l)}finally{d(!1)}}},me=t=>L(t),A=()=>L(null),R=s.productType==="Bundle";return e.jsxs("div",{className:"min-h-screen bg-gray-100 p-4 sm:p-8 font-sans",children:[e.jsxs("div",{className:"max-w-7xl mx-auto space-y-12",children:[" ",e.jsxs("div",{id:"product-form-section",className:"bg-white shadow-xl rounded-2xl p-6 md:p-10",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6 border-b pb-4",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800 flex items-center",children:[e.jsx(re,{className:"w-6 h-6 mr-2 text-indigo-600"}),p?"Edit Product":"Add New Product"]}),p&&e.jsx("button",{onClick:I,className:"text-sm font-medium text-indigo-600 hover:text-indigo-800 px-3 py-1 border border-indigo-200 rounded hover:bg-indigo-50",children:"Cancel Edit / Add New"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:p?`Updating product ID: ...${(z=s._id)==null?void 0:z.slice(-6)}. Upload images to ADD to existing.`:"Define core properties, bundle items if applicable."}),m&&e.jsx("div",{className:`p-3 mb-6 rounded-lg font-medium text-sm border ${m.startsWith("Error")?"bg-red-50 text-red-700 border-red-300":"bg-green-50 text-green-700 border-green-300"}`,children:m}),e.jsxs("form",{onSubmit:ne,className:"space-y-8",children:[e.jsxs("fieldset",{className:"bg-indigo-50 p-4 rounded-xl border border-indigo-200",children:[e.jsxs("legend",{className:"block text-lg font-semibold text-indigo-800 mb-3",children:[e.jsx(U,{className:"w-5 h-5 inline mr-2 align-text-bottom"})," Product Type"]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:" "})]}),e.jsx("fieldset",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 border-t pt-6",children:e.jsx("legend",{className:"md:col-span-2 text-xl font-bold text-gray-800 mb-4",children:" General Details "})}),!R&&e.jsx("fieldset",{className:"grid grid-cols-1 md:grid-cols-3 gap-x-6 gap-y-4 border-t pt-6",children:e.jsx("legend",{className:"md:col-span-3 text-xl font-bold text-gray-800 mb-4",children:" Product Specifications "})}),e.jsx("fieldset",{className:"space-y-4 border-t pt-6",children:e.jsx("legend",{className:"text-xl font-bold text-gray-800 mb-4",children:" Description "})}),e.jsxs("fieldset",{className:"border-t pt-6",children:[e.jsxs("legend",{className:"text-xl font-bold text-gray-800 mb-4",children:["Images (Max 5 total) ",!p&&e.jsx("span",{className:"text-red-500",children:"* Required for new"})]}),p&&s.imagePaths&&s.imagePaths.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Current Images:"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:s.imagePaths.map((t,r)=>e.jsx("div",{className:"relative group w-20 h-20 rounded-lg overflow-hidden border border-gray-200",children:e.jsx("img",{src:t,alt:`Current ${r+1}`,className:"w-full h-full object-cover"})},r))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Upload new images below to add more (up to 5 total)."})]}),e.jsx("input",{type:"file",id:"file-upload",multiple:!0,accept:"image/*",onChange:le,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"}),e.jsx("input",{type:"file",id:"file-upload"}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:" High-res JPG/PNG recommended. "}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-3"})]}),R&&e.jsx("fieldset",{className:"bg-yellow-50 p-6 rounded-xl border border-yellow-200 space-y-6",children:e.jsxs("legend",{className:"text-xl font-bold text-yellow-800 flex items-center",children:[e.jsx(U,{className:"w-5 h-5 mr-2"})," Bundle Items (Up to 10)"]})}),e.jsx("div",{className:"pt-6 border-t",children:e.jsx("button",{type:"submit",disabled:c,className:"w-full flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-xl shadow-lg text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition duration-150 ease-in-out"})})]})]}),w&&e.jsx("p",{className:"text-center text-gray-600 py-10",children:"Loading management sections..."}),!w&&e.jsxs("div",{id:"product-list-section",className:"bg-white shadow-xl rounded-2xl p-6 md:p-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Manage Products"}),h.length===0?e.jsx("p",{className:"text-gray-500",children:"No products found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsx("table",{className:"min-w-full divide-y divide-gray-200",children:e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(t=>e.jsx("tr",{children:e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>de(t),title:"Edit",className:"text-indigo-600 hover:text-indigo-900 p-1 hover:bg-indigo-50 rounded",children:e.jsx(te,{size:16})}),e.jsx("button",{onClick:()=>ie(t._id,t.name_en||t.bundleName||t.name),title:"Delete",className:"text-red-600 hover:text-red-900 p-1 hover:bg-red-50 rounded",children:e.jsx(se,{size:16})})]})},t._id))})})})]}),!w&&e.jsxs("div",{id:"order-list-section",className:"bg-white shadow-xl rounded-2xl p-6 md:p-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Manage Orders"}),v.length===0?e.jsx("p",{className:"text-gray-500",children:"No orders found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsx("table",{className:"min-w-full divide-y divide-gray-200",children:e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e.jsx("select",{value:t.status,onChange:r=>ce(t._id,r.target.value)})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{onClick:()=>me(t),title:"View Details",className:"text-gray-500 hover:text-indigo-600 p-1 hover:bg-gray-100 rounded",children:e.jsx(ee,{size:16})})})]},t._id))})})})]}),P&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50",onClick:A,children:e.jsxs("div",{className:"relative mx-auto p-5 border w-full max-w-lg shadow-lg rounded-md bg-white",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-3",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Order Details (",P._id.slice(-6),")"]}),e.jsx("button",{onClick:A,className:"text-gray-400 hover:text-gray-600",children:e.jsx(ae,{size:20})})]}),e.jsxs("div",{className:"mt-3 text-sm space-y-3",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",new Date(P.createdAt).toLocaleString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total:"})," ",(V=P.totalAmount)==null?void 0:V.toFixed(2)," EGP"]})]}),e.jsx("div",{className:"mt-4 text-right",children:e.jsx("button",{onClick:A,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Close"})})]})})]})," "]})};g.AdminProductUploader=oe,Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})});
