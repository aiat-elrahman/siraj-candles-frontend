(function(h,s){typeof exports=="object"&&typeof module<"u"?s(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],s):(h=typeof globalThis<"u"?globalThis:h||self,s(h.AdminProductUploader={},h.React))})(this,function(h,s){"use strict";var A={exports:{}},b={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W=s,Z=Symbol.for("react.element"),H=Symbol.for("react.fragment"),X=Object.prototype.hasOwnProperty,K=W.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Y={key:!0,ref:!0,__self:!0,__source:!0};function D(l,i,x){var o,m={},a=null,u=null;x!==void 0&&(a=""+x),i.key!==void 0&&(a=""+i.key),i.ref!==void 0&&(u=i.ref);for(o in i)X.call(i,o)&&!Y.hasOwnProperty(o)&&(m[o]=i[o]);if(l&&l.defaultProps)for(o in i=l.defaultProps,i)m[o]===void 0&&(m[o]=i[o]);return{$$typeof:Z,type:l,key:a,ref:u,props:m,_owner:K.current}}b.Fragment=H,b.jsx=D,b.jsxs=D,A.exports=b;var e=A.exports;/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=l=>l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),O=(...l)=>l.filter((i,x,o)=>!!i&&o.indexOf(i)===x).join(" ");/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=s.forwardRef(({color:l="currentColor",size:i=24,strokeWidth:x=2,absoluteStrokeWidth:o,className:m="",children:a,iconNode:u,...C},N)=>s.createElement("svg",{ref:N,...$,width:i,height:i,stroke:l,strokeWidth:o?Number(x)*24/Number(i):x,className:O("lucide",m),...C},[...u.map(([E,w])=>s.createElement(E,w)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=(l,i)=>{const x=s.forwardRef(({className:o,...m},a)=>s.createElement(q,{ref:a,iconNode:i,className:O(`lucide-${Q(l)}`,o),...m}));return x.displayName=`${l}`,x};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=y("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=y("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=y("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=y("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=y("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=y("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),f="https://siraj-backend.onrender.com",k={subProductName:"Item",size:"",allowedScents:["Vanilla Cookie"]},P={_id:null,productType:"Single",category:"",price_egp:0,stock:0,status:"Active",featured:!1,name_en:"",description_en:"",scents:[],size:"",formattedDescription:"",burnTime:"",wickType:"",coverageSpace:"",bundleName:"",bundleDescription:"",bundleItems:[{...k,subProductName:"Big Jar Candle 1"},{...k,subProductName:"Big Jar Candle 2"},{...k,subProductName:"Wax Freshener"}],selectedFiles:[],imagePaths:[]},le=()=>{var L,R,z;const[l,i]=s.useState(P),[x,o]=s.useState(!1),[m,a]=s.useState(""),[u,C]=s.useState([]),[N,E]=s.useState([]),[w,T]=s.useState(!0),[p,U]=s.useState(!1),[c,F]=s.useState(null),v=s.useCallback(async()=>{try{const t=await fetch(`${f}/api/products?limit=1000&status=Active&status=Inactive`);if(!t.ok)throw new Error("Failed to fetch products");const r=await t.json();C(r.results||[])}catch(t){console.error("Error fetching products:",t),a(`Error: Could not load products. ${t.message}`)}},[]),S=s.useCallback(async()=>{try{const t=await fetch(`${f}/api/orders`);if(!t.ok)throw new Error("Failed to fetch orders");const r=await t.json();E(r||[])}catch(t){console.error("Error fetching orders:",t),a(`Error: Could not load orders. ${t.message}`)}},[]);s.useEffect(()=>{T(!0),Promise.all([v(),S()]).catch(t=>{}).finally(()=>T(!1))},[v,S]);const M=()=>{i(P),U(!1);const t=document.getElementById("file-upload");t&&(t.value=null),a("")};s.useCallback(t=>{},[]),s.useCallback(t=>{},[]),s.useCallback(t=>{},[]),s.useCallback(t=>{},[]);const oe=s.useCallback(t=>{},[]);s.useCallback(t=>{},[]),s.useCallback((t,r,n)=>{},[]),s.useCallback((t,r)=>{},[]),s.useCallback(()=>{},[l.bundleItems.length]),s.useCallback(t=>{},[]);const ie=async t=>{var B,V,G,J;if(t.preventDefault(),o(!0),a(""),!p&&l.selectedFiles.length===0){a("Error: Please upload at least one image for new products."),o(!1);return}let r={};const n=new FormData;l.selectedFiles.forEach(j=>{n.append("productImages",j)}),n.append("productData",JSON.stringify(r));const d=p?`${f}/api/products/${l._id}`:`${f}/api/products`,_=p?"PUT":"POST";try{const j=await fetch(d,{method:_,body:n}),g=await j.json();if(j.ok){const pe=p?"updated":"created",he=((B=g.product)==null?void 0:B.name_en)||((V=g.product)==null?void 0:V.bundleName)||((G=g.product)==null?void 0:G.name)||"product",ue=((J=g.product)==null?void 0:J._id)||"";a(`Success! Product "${he}" ${pe}. ID: ${ue}`),M(),await v()}else a(`Error ${p?"updating":"creating"} product: ${g.message||g.error||"Unknown API error"}`),console.error("API Error:",g)}catch(j){a("Network Error: Could not reach the server. Check CORS/API URL."),console.error("Submission Error:",j)}finally{o(!1)}},ce=t=>{const r=(t.scents||"").split(",").map(d=>d.trim()).filter(Boolean),n=(t.bundleItems||[]).map(d=>({...d,allowedScents:(d.allowedScents||"").split(",").map(_=>_.trim()).filter(Boolean)}));i({...P,...t,_id:t._id,scents:r,bundleItems:n,selectedFiles:[],imagePaths:t.imagePaths||[]}),U(!0),window.scrollTo(0,0),a("Editing product. Upload new images only if you want to add more.")},de=async(t,r)=>{if(window.confirm(`Are you sure you want to delete "${r}"? This cannot be undone.`)){o(!0),a("");try{const n=await fetch(`${f}/api/products/${t}`,{method:"DELETE"}),d=await n.json();n.ok?(a(`Success! Product "${r}" deleted.`),await v()):(a(`Error deleting product: ${d.message||d.error||"Unknown API error"}`),console.error("API Error:",d))}catch(n){a("Network Error: Could not reach the server."),console.error("Delete Error:",n)}finally{o(!1)}}},xe=async(t,r)=>{if(window.confirm(`Update order ${t} status to "${r}"?`)){o(!0),a("");try{const n=await fetch(`${f}/api/orders/${t}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:r})}),d=await n.json();n.ok?(a(`Success! Order ${t} status updated to ${r}.`),await S()):(a(`Error updating order status: ${d.message||d.error||"Unknown API error"}`),console.error("API Error:",d))}catch(n){a("Network Error: Could not reach the server."),console.error("Order Update Error:",n)}finally{o(!1)}}},me=t=>{F(t)},I=()=>{F(null)};return l.productType,e.jsxs("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-8 font-sans",children:[e.jsx("script",{src:"https://cdn.tailwindcss.com"}),e.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap",rel:"stylesheet"}),e.jsxs("div",{className:"max-w-6xl mx-auto space-y-10",children:[e.jsxs("div",{className:"bg-white shadow-xl rounded-2xl p-6 md:p-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800 flex items-center",children:[e.jsx(ne,{className:"w-6 h-6 mr-2 text-indigo-600"}),p?"Edit Product":"Admin Product Uploader"]}),p&&e.jsx("button",{onClick:M,className:"text-sm text-gray-500 hover:text-indigo-600",children:"Cancel Edit / Add New"})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-8",children:p?`Updating product ID: ${l._id}. Upload new images only to add them.`:"Define the core properties, and for bundles, specify the customizable items. Uses Cloudinary via your Render backend for image storage."}),m&&e.jsx("div",{className:`p-4 mb-6 rounded-lg font-medium text-sm ${m.startsWith("Error")?"bg-red-100 text-red-700 border border-red-300":"bg-green-100 text-green-700 border border-green-300"}`,children:m}),e.jsxs("form",{onSubmit:ie,className:"space-y-8",children:[e.jsxs("div",{className:"border-b pb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 border-b pb-2 mb-4",children:["Image Uploads (Max 5 total) ",!p&&e.jsx("span",{className:"text-red-500",children:"*"})]}),p&&l.imagePaths&&l.imagePaths.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Current Images:"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:l.imagePaths.map((t,r)=>e.jsx("img",{src:t,alt:`Current ${r+1}`,className:"w-16 h-16 object-cover rounded border"},r))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Upload new images below to add to the existing ones."})]}),e.jsx("input",{type:"file",id:"file-upload",multiple:!0,accept:"image/*",onChange:oe,className:"block w-full text-sm text-gray-500 /* ... rest of classes ... */"})]}),e.jsx("div",{className:"pt-6",children:e.jsx("button",{type:"submit",disabled:x,className:"w-full /* ... rest of classes ... */",children:x?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"w-5 h-5 mr-3 animate-spin"})," Submitting..."]}):p?"Update Product":"Submit Product / Bundle"})})]})]}),w&&e.jsx("p",{className:"text-center text-gray-600",children:"Loading management sections..."}),!w&&e.jsxs("div",{className:"bg-white shadow-xl rounded-2xl p-6 md:p-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Manage Products"}),u.length===0?e.jsx("p",{className:"text-gray-500",children:"No products found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Image"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price (EGP)"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(t=>{var r,n;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("img",{src:((r=t.imagePaths)==null?void 0:r[0])||"./images/placeholder.jpg",alt:"",className:"w-10 h-10 object-cover rounded"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:t.name_en||t.bundleName||t.name||"N/A"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:t.productType}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:(n=t.price_egp)==null?void 0:n.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:t.stock}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.status==="Active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.status})}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>ce(t),title:"Edit",className:"text-indigo-600 hover:text-indigo-900",children:e.jsx(se,{size:18})}),e.jsx("button",{onClick:()=>de(t._id,t.name_en||t.bundleName||t.name),title:"Delete",className:"text-red-600 hover:text-red-900",children:e.jsx(ae,{size:18})})]})]},t._id)})})]})})]}),!w&&e.jsxs("div",{className:"bg-white shadow-xl rounded-2xl p-6 md:p-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Manage Orders"}),N.length===0?e.jsx("p",{className:"text-gray-500",children:"No orders found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total (EGP)"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(t=>{var r,n;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 truncate",style:{maxWidth:"100px"},title:t._id,children:t._id}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:new Date(t.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:((r=t.customerInfo)==null?void 0:r.name)||"N/A"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:(n=t.totalAmount)==null?void 0:n.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e.jsxs("select",{value:t.status,onChange:d=>xe(t._id,d.target.value),className:`p-1 rounded text-xs ${t.status==="Delivered"?"bg-green-100 text-green-800":t.status==="Shipped"?"bg-blue-100 text-blue-800":t.status==="Processing"?"bg-yellow-100 text-yellow-800":t.status==="Cancelled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,disabled:x,children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Processing",children:"Processing"}),e.jsx("option",{value:"Shipped",children:"Shipped"}),e.jsx("option",{value:"Delivered",children:"Delivered"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{onClick:()=>me(t),title:"View Details",className:"text-gray-500 hover:text-indigo-600",children:e.jsx(ee,{size:18})})})]},t._id)})})]})})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50",onClick:I,children:e.jsxs("div",{className:"relative mx-auto p-5 border w-full max-w-lg shadow-lg rounded-md bg-white",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-3",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Order Details (",c._id.slice(-6),")"]}),e.jsx("button",{onClick:I,className:"text-gray-400 hover:text-gray-600",children:e.jsx(re,{size:20})})]}),e.jsxs("div",{className:"mt-3 text-sm space-y-3",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",new Date(c.createdAt).toLocaleString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",c.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Customer:"})," ",c.customerInfo.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",c.customerInfo.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",c.customerInfo.phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",c.customerInfo.address,", ",c.customerInfo.city]}),c.customerInfo.notes&&e.jsxs("p",{children:[e.jsx("strong",{children:"Notes:"})," ",c.customerInfo.notes]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Payment:"})," ",c.paymentMethod]}),e.jsx("hr",{}),e.jsx("p",{children:e.jsx("strong",{children:"Items:"})}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:c.items.map((t,r)=>{var n;return e.jsxs("li",{children:[t.name," x ",t.quantity," @ ",(n=t.price)==null?void 0:n.toFixed(2)," EGP",t.customization&&t.customization.length>0&&` (${t.customization.join(", ")})`]},r)})}),e.jsx("hr",{}),e.jsxs("p",{children:[e.jsx("strong",{children:"Subtotal:"})," ",(L=c.subtotal)==null?void 0:L.toFixed(2)," EGP"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Shipping:"})," ",(R=c.shippingFee)==null?void 0:R.toFixed(2)," EGP"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total:"})," ",(z=c.totalAmount)==null?void 0:z.toFixed(2)," EGP"]})]}),e.jsx("div",{className:"mt-4 text-right",children:e.jsx("button",{onClick:I,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Close"})})]})})]})," "]})};h.AdminProductUploader=le,Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});
